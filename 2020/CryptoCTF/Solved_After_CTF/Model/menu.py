#!/usr/bin/env python3

from Crypto.Util.number import *
from math import *

def genkey(nbit):
    while True:
        p, q = getPrime(nbit), getPrime(nbit)
        if gcd((p-1) // 2, (q-1) // 2) == 1:
            P, Q = (q-1) // 2, (p-1) // 2
            r = inverse(Q, P)
            e = 2 * r * Q  - 1
            return(p, q, e)

def encrypt(msg, pubkey):
    e, n = pubkey
    return pow(bytes_to_long(msg), e, n)

#encrypt(flag, pubkey) = 2708329571914945036471888222274113624245508583972934126477423097479263877699474512696996812336602520678611763609159451929254245206779857956132234568543641917315670043465638259838034453342994379906472320481413769271410499447850401300958570516297217859651898220903222661576757798367530784430486194044666145609417671890871942509652467231959763569387019621616640811490518902321201491009454802358622997716269721339929985872458465502057248976192851800635298301536635384878114693835306294143651439681147027165892418136124651408368770365517465716244859486466614147613317567898730728758449370934021224823254914436932352843101

n = 15499303621100578922298882679866814504204129192365099660794102417444867103491939514640188044364155359747651139962769958504656746862798735617462497749524255478583008818551817831887825622684300349947094800481957092603775383055132319015062329372256305250721421952439027534408649074120802032247960740163189188586238739225027207760871792450557758292110783655554437959846765203744880532837518109083961657290943924815345886016611704318213435144720308609633295100970906458822828377402268282907336018403490096358078846500769825205087294288306259509093900718956048744802821039505042012104463676251409803412042094109360741266859
nbit = 1024

nt = 0
while (nt != n):
    pt, qt, et = genkey(nbit)
    nt = pt * qt
    print(nt)
    print(pt, qt, et)
    print('-')

print("[+] Bruteforce over")
