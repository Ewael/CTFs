#!/usr/bin/env python3

from pwn import *
import binascii

ipt = b'a' * 83257 # <--- lol unintended sol, the rand buffer xoring ipt is not long enough
flag = 'actf{flag_flag}'
os.system(f'echo {flag} > flag')

# r = process('./thunder')
r = remote('crypto.2021.chall.actf.co', 21603)

r.recv()
r.sendline(ipt)
enc = r.recvuntil('\n')[:-1].decode('utf-8')
enc = binascii.unhexlify(enc)

log.info(f'flag = {flag}')
log.info(f'ipt = {ipt}')
log.info(f'enc = {enc}')
log.info(f'flag len = {len(enc)}')

"""
0x555555555246 = fgen
0x55555555525f = enc
xor 0x555555555538
"""

# actf{watch_the_edge_cases_31b2eb7440e6992c33f3e5bbd184}
