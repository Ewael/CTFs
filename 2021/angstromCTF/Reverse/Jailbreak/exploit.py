#!/usr/bin/env python3

from pwn import *

commands = '''
c
hb *0x000055555555519a
c
'''

# r = gdb.debug('./jailbreak', commands)
# r = process('./jailbreak')
r = remote('shell.actf.co', 21701)

def send(cmd):
    r.recvuntil('What would you like to do?\n')
    r.sendline(cmd)

def red():
    send('press the red button')

def green():
    send('press the green button')

send('pick the snake up')
send('throw the snake at kmh')
send('pry the bars open')
# ((((0x538/2/2/2-1)/2-1)/2-1)/2/2/2-1)/2/2 = 1 (we want 1337)
red() # 2
green() # 5
red() # 10
red() # 20
green() # 41
green() # 83
green() # 167
red() # 334
red() # 668
green() # 1337
send('bananarama')

r.interactive()

# actf{guess_kmh_still_has_unintended_solutions}
