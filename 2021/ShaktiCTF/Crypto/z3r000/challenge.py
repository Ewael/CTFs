#!/usr/bin/env python3

from Crypto.Util.number import *

def find_invpow(x,n):
    """Finds the integer component of the n'th root of x,
    an integer such that y ** n <= x < (y + 1) ** n.
    """
    high = 1
    while high ** n <= x:
        high *= 2
    low = high/2
    while low < high:
        mid = (low + high) // 2
        if low < mid and mid**n < x:
            low = mid
        elif high > mid and mid**n > x:
            high = mid
        else:
            return mid
    return mid + 1

flag = b"shaktictf{alloALLOLFVWF}"

n = 21715343886495928351215193978711929756420132478733511337712828323191033721473249522742310880995705726364659155923831862520713609810234090293129894330795897314385036353796299339012807424848725536681375374406626571246675194305322084373494309780483230258395289370971774836794623911704539272083398677190964132595561342176374613443236001057127606148055300330917664419125803955455242203465159778064534281149697964754267795556384685979413144901477909683027731425979539827440413451284858488486792558571039442704074516658347717422970337132798573245689067635331499343815761456951640935339048955499678787141314816545395882094131
e = 3

padding = b"\x00" * 200
print(f'flag = {bytes_to_long(flag)}')
print(f'pad = {bytes_to_long(padding)}')

tflag = bytes_to_long(flag) * 256**200
print(f'tflag = {tflag}')

pflag = flag + padding
print(f'padded flag = {bytes_to_long(pflag)}')

ct = pow(bytes_to_long(pflag), e, n)
print(f'n = {n}')
print(f'ct = {ct}')

f = bytes_to_long(flag)
a = (f**3 * 256**600) % n
print(f'a = {a}')

# --------

ct = 19258881721319838539457302108079805924007184173822525342017749987730421113475524675098820917522804638672433509736065357049144293036488371316019861512588425245150715231139464779572365549429694270196306310887787115617307657620629796823034717298229261451513996300641103453971960273159526614861159508208543734860681157877266608856017428170839087144791926229543722615522167842436520721255660377919759130818061138963229370323538021083594114722358233907874550197614395737551656382256624656798688943064922359100344464350636071751200925945768396168482676392175499672384759914433676349457259681832749703857971930447279797608485

m3 = ct / pow(256, 600)
print(m3)
