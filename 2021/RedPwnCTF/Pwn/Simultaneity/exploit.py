#!/usr/bin/env python3

from Crypto.Util.number import bytes_to_long
from pwn import *
from time import sleep

service = 'mc.ax'
port = 31547
binary = './simultaneity'

commands = '''
b main
c
# last scanf
b *main+211
c
ni
'''
if len(sys.argv) > 1 and sys.argv[1] == 'debug':
    r = gdb.debug([binary], commands)
elif len(sys.argv) > 1 and sys.argv[1] == 'local':
    r = process(binary)
else:
    r = remote(service, port)

buff = 0x55555555b270

size = 0
index = 0 # can be negative
pld = 0x4141414142424242

sleep(0.5)
r.recv()
r.sendline(str(size))
sleep(0.5)
r.recv()
r.sendline(str(index))
sleep(0.5)
r.recv()
r.sendline(str(pld))

r.interactive()

# did not solve it, still very interesting, better keep the sol:
# https://github.com/volticks/CTF-Writeups/blob/main/redpwn%202021/Simultaneity/README.md
