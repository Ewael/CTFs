#!/usr/bin/env python3

from pwn import *

# (((secret * 0xb5 + 0xd9) % 0x200) << 0x4) + 0x000000000040127d
# index 0 -> 0x4024bd

i0 = 0x4024bd
a = (i0 - 0x000000000040127d) >> 0x4

secret = 0
for i in range(0, 100):
    b = a + 0x200 * i
    c = b - 0xd9
    if c % 0xb5 == 0:
        secret = c // 0xb5
        break

print(f'secret = {secret} = {hex(secret)}')

a = secret * 0xb5
b = a + 0xd9
c = b % 0x200
d = c << 0x4
addr = d + 0x000000000040127d
print(f'a = {hex(a)}')
print(f'b = {hex(b)}')
print(f'c = {hex(c)}')
print(f'd = {hex(d)}')
print(f'addr = {hex(addr)}')

x = [(0x476d, 0x12b),
(0x4341, 0x2),
(0x52ae, 0x1fd),
(0x43cf, 0x8c),
(0x7a24, 0x15f),
(0x6007, 0x166),
(0x67b7, 0x1d1),
(0x3322, 0x110),
(0x33e1, 0x1d3),
(0x6369, 0xa),
(0x6783, 0x1e5),
(0x64b0, 0xd4),
(0x64e3, 0x87),
(0x35da, 0x1ee),
(0x360f, 0x39),
(0x63ba, 0x1d8),
(0x671d, 0x17b),
(0x6271, 0x112),
(0x38f5, 0xcd),
(0x312d, 0x1c),
(0x309f, 0xaf),
(0x3443, 0x176),
(0x62c2, 0x1a1),
(0x63c2, 0x1a0),
(0x3211, 0x23),
(0x3922, 0x11a),
(0x65d0, 0xb5),
(0x3054, 0x64),
(0x35e3, 0x1d7),
(0x38c7, 0x1fe),
(0x3831, 0x9),
(0x3850, 0x68),
(0x67ad, 0x1cb),
(0x391b, 0x22),
(0x31ad, 0x19d),
(0x3598, 0x1ac),
(0x31cf, 0x1ff),
(0x35b2, 0x186),
(0x3848, 0x171),
(0x6454, 0x30),
(0x6417, 0x73),
(0x361c, 0x2a),
(0x31b5, 0x185),
(0x6396, 0x1f4),
(0x6442, 0x127),
(0x313f, 0xe),
(0x33eb, 0x1d9),
(0x34cc, 0xf8),
(0x352e, 0x1b),
(0x3605, 0x132),
(0x315c, 0x6d),
(0x3904, 0x13c),
(0x6729, 0x14f),
(0x67f0, 0x196),
(0x6424, 0x141),
(0x66a6, 0xc0),
(0x35f6, 0xc3),
(0x6358, 0x13a),
(0x396c, 0x55),
(0x63e6, 0x184),
(0x6215, 0x77),
(0x6678, 0x1e),
(0x3890, 0x1a9),
(0x63ea, 0x188),
(0x355e, 0x6b),
(0x3072, 0x42),
(0x3804, 0x13d),
(0x64a8, 0xcc),
(0x35aa, 0x9f),
(0x7cdb, 0x1a6)]

flag = ''

for i in range(len(x)):
    xored = x[i][0] ^ x[i][1]
    flag += chr(int(hex(xored)[2:4], 16))

print(flag)

# FCSC{af22cfdd46bfc8105cb28e04988f904049dd60be1245718ffef5b9bbf9b509d5}
